(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{52:function(e,t,n){e.exports=n(87)},86:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),u=n.n(c),l=n(14),s=n(7),o=n(8),i=n(89),m=function(){var e=Object(s.c)((function(e){return e.blogs}));return r.a.createElement("div",{className:"blogList"},r.a.createElement(i.a,{striped:!0},r.a.createElement("tbody",null,e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(l.b,{to:"/blogs/".concat(e.id)},e.title)))})))))},p=n(3),d=n.n(p),f=n(6),b=n(92),E=n(90),v=n(17),g=n.n(v),h={login:function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},O=n(19),w=function(){var e=Object(f.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.a.get("/api/users"),e.next=3,t;case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j={create:function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAll:w},y=null,x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return function(){var n=Object(f.a)(d.a.mark((function n(a){return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"SET_MESSAGE",text:e}),clearTimeout(y),y=setTimeout((function(){a({type:"CLEAR_MESSAGE"})}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return function(){var n=Object(f.a)(d.a.mark((function n(a){return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"SET_ERROR",text:e}),clearTimeout(y),y=setTimeout((function(){a({type:"CLEAR_MESSAGE"})}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":return{text:t.text,variant:"success"};case"SET_ERROR":return{text:t.text,variant:"danger"};case"CLEAR_MESSAGE":return"";default:return e}},N=function(){var e=Object(s.b)(),t=Object(a.useState)(""),n=Object(O.a)(t,2),c=n[0],u=n[1],l=Object(a.useState)(""),o=Object(O.a)(l,2),i=o[0],m=o[1],p=Object(a.useState)(""),v=Object(O.a)(p,2),g=v[0],h=v[1],w=function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={username:c,password:i,name:g},u(""),m(""),h(""),t.prev=5,t.next=8,j.create(a);case 8:200===t.sent.status&&e(x("User created")),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),e(k("user creation failed"));case 15:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(b.a,{className:"userCreateForm",onSubmit:w},r.a.createElement(b.a.Control,{placeholder:"New username",value:c,name:"new username",onChange:function(e){return u(e.target.value)}}),r.a.createElement(b.a.Control,{placeholder:"New Password",value:i,name:"new password",onChange:function(e){return m(e.target.value)}}),r.a.createElement(b.a.Control,{placeholder:"Name",value:g,name:"new name",onChange:function(e){return h(e.target.value)}}),r.a.createElement(E.a,{type:"submit"},"create new user"))},C=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(O.a)(n,2),u=c[0],l=c[1],s=Object(a.useState)(!1),o=Object(O.a)(s,2),i=o[0],m=o[1],p={display:u?"none":""},d={display:u?"":"none"},f=function(){l(!u)},b=function(){m(!i)};return Object(a.useImperativeHandle)(t,(function(){return{toggleExpanded:b}})),r.a.createElement("span",null,r.a.createElement("span",{style:p},r.a.createElement(E.a,{variant:"info",onClick:f,className:"infoEnable"},e.buttonLabel)),r.a.createElement("span",{style:d,className:"togglableComponent"},r.a.createElement(E.a,{variant:"secondary",onClick:f,className:"infoDisable"},"hide"),e.children))}));C.displayName="Togglable";var I=C,T=n(10),L=null,U=function(){var e=Object(f.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.a.get("/api/blogs"),e.next=3,t;case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:L}},e.next=3,g.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(f.a)(d.a.mark((function e(t,n){var a,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:L}},r="".concat("/api/blogs","/").concat(t),e.next=4,g.a.put(r,n,a).catch((function(e){console.log("err",e),console.log(),console.log("config.headers :>> ",a.headers),console.log("newObject :>> ",n)}));case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:L}},e.next=3,g.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return e.abrupt("return",U());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B={getAll:U,create:R,update:_,setToken:function(e){L="bearer ".concat(e)},removeBlog:A,createComment:function(){var e=Object(f.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("".concat("/api/blogs","/").concat(t,"/comments"),{comment:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},G=function(e){return function(t){t({type:"LOGIN",data:e})}},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loggedInUser:null,allUsers:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return Object(T.a)(Object(T.a)({},e),{},{allUsers:t.data});case"RETRIEVE_USERS":return B.setToken(t.data.token),Object(T.a)(Object(T.a)({},e),{},{loggedInUser:t.data});case"LOGIN":return window.localStorage.setItem("loggedInUser",JSON.stringify(t.data)),B.setToken(t.data.token),Object(T.a)(Object(T.a)({},e),{},{loggedInUser:t.data});case"LOGOUT":return window.localStorage.removeItem("loggedInUser"),Object(T.a)(Object(T.a)({},e),{},{loggedInUser:null});case"CREATE_USER":default:return e}},M=function(){var e=Object(s.b)(),t=Object(o.f)(),n=function(){var n=Object(f.a)(d.a.mark((function n(a){var r,c;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a.preventDefault(),r=a.target,n.prev=2,n.next=5,h.login({username:r.username.value,password:r.password.value});case 5:c=n.sent,e(G(c)),e(x("logged in")),t.push("/"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),e(k("login failed"));case 14:case"end":return n.stop()}}),n,null,[[2,11]])})));return function(e){return n.apply(this,arguments)}}();return r.a.createElement("div",{className:"login"},r.a.createElement(b.a,{className:"loginForm",onSubmit:n},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{name:"username",placeholder:"Username"})," ",r.a.createElement("br",null),r.a.createElement(b.a.Control,{name:"password",placeholder:"password",type:"password"}),r.a.createElement("br",null),r.a.createElement(E.a,{variant:"primary",type:"submit"},"login"))),r.a.createElement(I,{className:"newUser",buttonLabel:"create user"},r.a.createElement("h4",null,"Create new user"),r.a.createElement(N,null)))},J=n(22),z=n(51),F=function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.removeBlog(e.id);case 2:a=t.sent,n({type:"DELETE_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},H=function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.update(e.id,Object(T.a)(Object(T.a)({},e),{},{likes:e.likes+1,user:e.user.id}));case 2:a=t.sent,n({type:"LIKE_BLOG",data:Object(T.a)(Object(T.a)({},a),{},{user:e.user})});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return[].concat(Object(z.a)(e),[t.data]);case"DELETE_BLOG":return t.data;case"ADD_COMMENT":var n=e.find((function(e){return e.id===t.data.blog})),a=Object(T.a)(Object(T.a)({},n),{},{comments:t.data.comments});console.log("newBlog :>> ",a);var r=e.map((function(e){return e.id!==t.data.blog?e:a}));return r;case"LIKE_BLOG":return e.map((function(e){return e.id!==t.data.id?e:t.data})).sort((function(e,t){return e.content<t.content?1:-1})).sort((function(e,t){return e.likes<t.likes?1:-1}));default:return e}},V=function(e,t){var n=Object(a.useState)(""),r=Object(O.a)(n,2),c=r[0],u=r[1];return{type:e,value:c,placeholder:t,onChange:function(e){u(e.target.value)},reset:function(){u("")}}},W=function(){var e=Object(s.b)(),t=V("text","title"),n=t.reset,a=Object(J.a)(t,["reset"]),c=V("text","author"),u=c.reset,l=Object(J.a)(c,["reset"]),o=V("text","url"),i=o.reset,m=Object(J.a)(o,["reset"]);return r.a.createElement("span",null,r.a.createElement(b.a,{className:"blogForm",onSubmit:function(t){t.preventDefault();var r={title:a.value,author:l.value,url:m.value,likes:0};e(function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.create(e);case 2:a=t.sent,n({type:"CREATE_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(r)),e(x("added new blog")),n(),u(),i()}},r.a.createElement("h3",null,"Add new blog"),r.a.createElement(b.a.Control,a),r.a.createElement(b.a.Control,l),r.a.createElement(b.a.Control,m),r.a.createElement(E.a,{variant:"primary",type:"submit"},"save")))},P=n(91),q=function(){var e=Object(s.c)((function(e){return e.notification}));return null!==e.text?r.a.createElement(P.a,{variant:e.variant},e.text):null},Q=function(){var e=Object(s.c)((function(e){return e.users.allUsers}));return r.a.createElement("div",{className:"userList"},r.a.createElement("h2",null,"Users"),r.a.createElement(i.a,{striped:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Username"),r.a.createElement("th",null,"Blog Count"))),r.a.createElement("tbody",null,e.map((function(e){return r.a.createElement("tr",{key:e.username},r.a.createElement("td",null,r.a.createElement(l.b,{to:"/users/".concat(e.username)},e.username)),r.a.createElement("td",null,e.blogs.length))})))))},X=function(e){var t=e.user,n={border:"solid",padding:5,borderWidth:1};return t?r.a.createElement("div",{className:"blogList"},r.a.createElement("h1",null,"Blogs added by ",t.username),r.a.createElement(i.a,{striped:!0},r.a.createElement("tbody",null,t.blogs.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",{style:n},r.a.createElement(l.b,{to:"/blogs/".concat(e.id)},e.title)))}))))):null},Y=n(93),Z=function(e){var t=e.blog,n=Object(s.b)(),a=V("text","comment"),c=(a.reset,Object(J.a)(a,["reset"])),u=Object(s.c)((function(e){return e.users.loggedInUser})),l=function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("delete blog ".concat(t.title,"?"))&&n(F(t));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(H(t));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t?r.a.createElement("div",{className:"blog"},r.a.createElement(Y.a,{className:"blogCard"},r.a.createElement(Y.a.Header,null,r.a.createElement("h1",null,t.title),r.a.createElement(E.a,{className:"cardBtn",variant:"success",href:t.url},"Source")),r.a.createElement("div",{className:"inline"},"Likes: ",t.likes,r.a.createElement(E.a,{className:"cardBtn",onClick:o,id:"likeBtn"},"like")),"added by:",t.user.username,u.username===t.user.username?r.a.createElement("span",null,r.a.createElement(E.a,{variant:"danger",onClick:l},"delete"),r.a.createElement("br",null)):r.a.createElement("div",null)),r.a.createElement("div",{className:"card",style:{width:"60rem"}},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",null,"Comments")),r.a.createElement("ul",{className:"list-group list-group-flush"},t.comments.map((function(e){return r.a.createElement("li",{key:e._id,className:"list-group-item"},e.content)})))),r.a.createElement(b.a,null,r.a.createElement(b.a.Control,c),r.a.createElement(E.a,{variant:"success",onClick:function(){n(function(e,t){return function(){var n=Object(f.a)(d.a.mark((function n(a){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,B.createComment(t.id,e);case 2:r=n.sent,a({type:"ADD_COMMENT",data:{blog:t.id,comments:r}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(c.value,t))}},"Submit"))):null},$=function(){var e=Object(s.b)(),t=Object(o.f)(),n=Object(s.c)((function(e){return e.users})),a={color:"white",padding:"14px 10px",textAlign:"center",textDecoration:"none",display:"inline-block"};return r.a.createElement("div",{className:"topBar"},r.a.createElement(l.b,{style:a,to:"/"},r.a.createElement("h2",null,"Blogs")),r.a.createElement(l.b,{style:a,to:"/users"},r.a.createElement("h2",null,"Users")),n.loggedInUser?r.a.createElement("span",{className:"logged"},n.loggedInUser.username," logged in",r.a.createElement(E.a,{variant:"danger",className:"logBtn",onClick:function(){e((function(e){e({type:"LOGOUT"})})),e(x("logged out")),t.push("/login")}},"log out")):r.a.createElement(E.a,{variant:"success",className:"logBtn",onClick:function(){t.push("/login")}},"login"))},ee=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.users})),n=Object(s.c)((function(e){return e.blogs}));Object(a.useEffect)((function(){e(function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n.sort((function(e,t){return e.likes-t.likes})).reverse()});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n.sort((function(e,t){return e.blogs.length-t.blogs.length})).reverse()});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(a.useEffect)((function(){var t,n=window.localStorage.getItem("loggedInUser");n&&e((t=JSON.parse(n),function(e){e({type:"RETRIEVE_USERS",data:t})}))}),[e]);var c=Object(o.g)("/users/:username"),u=c?t.allUsers.find((function(e){return e.username===c.params.username})):null,l=Object(o.g)("/blogs/:id"),i=l?n.find((function(e){return e.id===l.params.id})):null;return r.a.createElement("span",null,r.a.createElement($,null),r.a.createElement("div",{className:"container"},r.a.createElement(q,null),r.a.createElement(o.c,null,r.a.createElement(o.a,{path:"/login"},r.a.createElement(M,null)),r.a.createElement(o.a,{path:"/",exact:!0},r.a.createElement("div",{className:"blogList"},r.a.createElement("h1",null,"Blogs"),r.a.createElement(m,null))),r.a.createElement(o.a,{path:"/users",exact:!0},r.a.createElement(Q,null)),r.a.createElement(o.a,{path:"/users/:username"},r.a.createElement(X,{user:u})),r.a.createElement(o.a,{path:"/blogs/:id"},r.a.createElement(Z,{blog:i})))),r.a.createElement(o.a,{path:"/",exact:!0},r.a.createElement(I,{buttonLabel:"add a new blog"},r.a.createElement(W,null))))},te=n(21),ne=n(49),ae=n(50),re=Object(te.combineReducers)({blogs:K,notification:S,users:D}),ce=Object(te.createStore)(re,Object(ae.composeWithDevTools)(Object(te.applyMiddleware)(ne.a))),ue=(n(86),ce);u.a.render(r.a.createElement(l.a,null,r.a.createElement(s.a,{store:ue},r.a.createElement(ee,null))),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.4cd0a187.chunk.js.map